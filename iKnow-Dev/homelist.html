<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		<title>iKnow</title>
		<script src="js/mui.js"></script>
		<script src="js/template.js"></script>
		<link href="css/mui.css" rel="stylesheet" />
		<link rel="stylesheet" href="css/font-awesome.css">
		<script id="serviceslist" type="text/html ">
			{{each list as value i}}
			<li data-id="{{i}}" class="mui-table-view-cell mui-media">
				<a>
					<img class="mui-media-object-large mui-pull-left" style="width:100%;height:100%" src="{{value.pic}}">
					<div class="mui-media-body ">
						{{value.servicename}}
						<p class='mui-ellipsis mui-services-provider'>{{value.shopname}}</p>
						<p class='mui-pull-right mui-service-distance'>1.1km</p>
						<span class='mui-price'>￥{{value.price}}</span>
					</div>
				</a>
			</li>
			{{/each}}
		</script>

		<script id="massagistslist" type="text/html ">
			{{each list as value i}}
			<li data-id="{{i}}" class="mui-table-view-cell mui-media ">
					<a href="javascript:; ">
						<div class="pull-left mui-media-object-round " style="margin:10px 0 0 10px;background-image: url({{value.pic}});width:64px;height:64px;background-size: cover; ">
						</div>
						<div class="mui-media-body mui-media-body-massagistlist ">
							{{value.name}}
							<p class='mui-pull-right mui-distance'>1.1km</p>
							<p class='mui-ellipsis mui-massagist-provider'>{{value.shopname}}</p>
							<p class='mui-ellipsis-2' ; ">{{value.intro}}</p>
						</div>
					</a>
				</li>
			{{/each}}
		</script>
		<script type="text/javascript" charset="utf-8">
			mui.init();
			mui.plusReady(function() {
				document.getElementById("slideshow").addEventListener('tap', function(e) {
					//显示引导页
					mui.openWindow({
						id: 'guide',
						url: 'guide.html',
						show: {
							aniShow: 'fade-in',
							duration: 300
						},
						waiting: {
							autoShow: false
						},
					});
				});
				document.getElementById("servicelistbtn").addEventListener('tap', function(e) {
					//显示热门服务列表页
					mui.openWindow({
						id: 'serviceslist',
						url: 'serviceslist.html',
						show: {
							aniShow: 'pop-in',
							duration: 300
						},
						waiting: {
							autoShow: false
						},
					});
				});
				document.getElementById("servicecategorybtn").addEventListener('tap', function(e) {
					//显示热门服务分类页
					mui.openWindow({
						id: 'servicecategory',
						url: 'servicecategory.html',
						show: {
							aniShow: 'pop-in',
							duration: 300
						},
						waiting: {
							autoShow: false
						},
					});
				});
				document.getElementById("massagistlistbtn").addEventListener('tap', function(e) {
					//显示金牌保健师列表页
					mui.openWindow({
						id: 'massagistslist',
						url: 'massagistslist.html',
						show: {
							aniShow: 'pop-in',
							duration: 300
						},
						waiting: {
							autoShow: true
						},
					});
				});
				plus.webview.currentWebview().setStyle({
					scrollIndicator: 'none'
				});
//				document.getElementById("Services").addEventListener('tap', function() {
//					//显示服务详情页
//					mui.openWindow({
//						id: 'service_detail',
//						url: 'service_detail.html',
//						show: {
//							aniShow: 'pop-in',
//							duration: 300
//						},
//						waiting: {
//							autoShow: false
//						},
//					});
//				});
				mui.ajax('http://gene.rnet.missouri.edu/iKnow/servicelist.php', {
					data: {
						action: 'get_services_list'
					},
					type: 'post', //HTTP请求类型 
					timeout: 100000, //超时时间设置为10秒；  
					success: function(data) {
						var obj = JSON.parse(data)
						var html = template('serviceslist', {
							list: obj
						});
						console.log(obj[0].serviceid);
						document.getElementById('Services').innerHTML = html;
						mui('#Services').on('tap','li',function(){
							mui.openWindow({
								url:'service_detail.html',
								id:'service_detail',
								extras:{
									serviceid:obj[this.getAttribute('data-id')].serviceid,
								},
								show: {
									autoShow: true, //页面loaded事件发生后自动显示，默认为true
									aniShow: 'pop-in', //页面显示动画，默认为”slide-in-right“；
									duration: 300 //页面动画持续时间，Android平台默认100毫秒，iOS平台默认200毫秒；
								},
								waiting: {
									autoShow: true, //自动显示等待框，默认为true
									title: '正在加载...', //等待对话框上显示的提示内容
								}
							})
						})
					},
					error: function(xhr, type, errorThrown) {
						console.log(type);
						console.log(JSON.stringify(xhr));
					}
				});
				
				mui.ajax('http://gene.rnet.missouri.edu/iKnow/massagistlist.php', {
					data: {
						action: 'get_massagist_list'
					},
					type: 'post', //HTTP请求类型 
					timeout: 100000, //超时时间设置为10秒；  
					success: function(data) {
						var obj = JSON.parse(data)
						var html = template('massagistslist', {
							list: obj
						});
						console.log(data);
						document.getElementById('massagist').innerHTML = html;
						mui('#massagist').on('tap','li',function(){
							mui.openWindow({
								url:'massagistslist.html',
								id:'massagistslist',
								extras:{
									massagistid:obj[this.getAttribute('data-id')].massagistid
								},
								show: {
									autoShow: true, //页面loaded事件发生后自动显示，默认为true
									aniShow: 'pop-in', //页面显示动画，默认为”slide-in-right“；
									duration: 300 //页面动画持续时间，Android平台默认100毫秒，iOS平台默认200毫秒；
								},
								waiting: {
									autoShow: true, //自动显示等待框，默认为true
									title: '正在加载...', //等待对话框上显示的提示内容
								}
							})
						})
					},
					error: function(xhr, type, errorThrown) {
						console.log(type);
						console.log(JSON.stringify(xhr));
					}
				});
			})
		</script>
		<style>
			html,
			body {
				min-height: 100%;
				background-color: #efeff4;
			}
			,
			.nopaddingleft {
				padding-left: 0px;
			}
		</style>
	</head>

	<body>
		<div class="mui-content">
			<div id="slideshow" class="mui-slider" style="height:160px" ;>
				<div class="mui-slider-group">
					<div class="mui-slider-item">
						<a id="slider-image" href="javascript:;"><img src="http://gene.rnet.missouri.edu/iKnow/img/slide/slide1.jpg" /></a>
					</div>
					<div class="mui-slider-item">
						<a href="#"><img src="http://gene.rnet.missouri.edu/iKnow/img/slide/slide2.jpg" /></a>
					</div>
					<div class="mui-slider-item">
						<a href="#"><img src="http://gene.rnet.missouri.edu/iKnow/img/slide/slide3.jpg" /></a>
					</div>
					<div class="mui-slider-item">
						<a href="#"><img src="http://gene.rnet.missouri.edu/iKnow/img/slide/slide4.jpg" /></a>
					</div>
				</div>
			</div>

			<ul class="mui-table-view" style="margin:15px 0px 0px 0px;line-height: 40px;">
				<li class="mui-table-view-cell">
					<a id="servicecategorybtn"class="mui-navigate-right" style="color:#56abe4">
						预约服务
					</a>
				</li>
			</ul>
			<ul class="mui-table-view mui-grid-view" style="margin-bottom: 15px;padding-right:0px;padding-top: 10px;">
				<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
					<a href="#" style="padding-top:0px">
						<span class="mui-icon"><img src="img/anmo.png" style="width:36px;height:36px"/></span>
						<div class="mui-media-body" style="padding-left: 0px;color: #fc663d;margin-top:0px">推拿按摩</div>
					</a>
				</li>
				<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
					<a href="#" style="padding-top:0px">
						<span class="mui-icon"><img src="img/yuchang.png" style="width:36px;height:36px"/></span>
						<div class="mui-media-body" style="padding-left: 0px;color: #6bcdfd;margin-top:0px">汗蒸浴场</div>
					</a>
				</li>
				<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
					<a href="#" style="padding-top:0px">
						<span class="mui-icon"><img src="img/huoguan.png" style="width:36px;height:36px"/></span>
						<div class="mui-media-body" style="padding-left: 0px;color: #6acb9a;margin-top:0px">刮痧火罐</div>
					</a>
				</li>
				<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
					<a href="#" style="padding-top:0px">
						<span class="mui-icon"><img src="img/zuliao.png" style="width:36px;height:36px"/></span>
						<div class="mui-media-body" style="padding-left: 0px;color: #ff9600;margin-top:0px">足疗养生</div>
					</a>
				</li>
			</ul>

			<ul class="mui-table-view" style="margin:15px 0px 0px 0px;line-height: 40px;">
				<li class="mui-table-view-cell">
					<a id='servicelistbtn' class="mui-navigate-right" style="color:#56abe4">
						热门服务
					</a>
				</li>
			</ul>
			<ul id="Services" class="mui-table-view">

			</ul>

			<ul class="mui-table-view" style="margin:15px 0px 0px 0px;line-height: 40px;">
				<li class="mui-table-view-cell">
					<a id='massagistlistbtn' class="mui-navigate-right" style="color:#56abe4">
						金牌保健师
					</a>
				</li>
			</ul>
			<ul id="massagist" class="mui-table-view">
			</ul>
		</div>

	</body>

</html>